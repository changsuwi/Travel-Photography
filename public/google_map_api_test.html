<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Info windows</title>
    <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

    #map {
        height: 100%;
    }
    /* Optional: Makes the sample page fill the window. */

    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
    }
    </style>
</head>

<body>
    <div id="map"></div>
    <script>
    // This example displays a marker at the center of Australia.
    // When the user clicks the marker, an info window opens.
    function get_json(url, callback) {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    // Here the callback gets implemented
                    var item = JSON.parse(xhr.responseText);
                    callback(item);
                } else {

                }
            }
        };

        xhr.open("GET", url, true);
        xhr.send();
    }

    function initMap() {
        var icon_image = 'http://maps.google.com/mapfiles/ms/micons/camera.png';
        var center = { lat: 25.0894062, lng: 121.8475243 };
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 14,
            center: center,
        });
        var marker = new google.maps.Marker({
            map: map,
            position: center,
        });
        get_json("ajax_data", function(data) {
            for(var k in data){
                var placeid = data[k].placeid;
                var name = data[k].name;
                var hot = data[k].hot;
                var lat = data[k].lat;
                var lng = data[k].lng;
                var description = data[k].description;
                var point = new google.maps.LatLng(lat, lng);
                var marker = new google.maps.Marker({
                    map: map,
                    position: point,
                    title: name,
                    icon: icon_image
                });
                console.log(data[k].placeid);
                var contentString = '<div id="content">' +
                    '<div id="siteNotice">' +
                    '</div>' +
                    '<h1>' + name + '</h1>' +
                    '<p>' + description + '</p>' +
                    '</div>';

                marker['infowindow'] = new google.maps.InfoWindow({
                    content: contentString
                });

                google.maps.event.addListener(marker, 'mouseover', function() {
                    this['infowindow'].open(map, this);
                });

                google.maps.event.addListener(marker, 'mouseout', function() {
                    this['infowindow'].close();
                });
            }

            
        });

    }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAeVo8TE2AGQ24zvvwF8otKrCQCtory7rA&callback=initMap">
    </script>
</body>

</html>